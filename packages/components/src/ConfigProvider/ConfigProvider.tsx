import { ReactNode, createContext, useEffect } from 'react';

import { LanguageMap } from '../DatePicker/types';
import { russianMap } from '../DatePicker/constants/russianMap';

const imagesMapDefault = {
  noDataImgSrc:
    'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyNi4wLjMsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCAxMjQgMTI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMjQgMTI0OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDojRUJFRUYxO3N0cm9rZTojQjdDMkNFO30NCgkuc3Qxe2ZpbGw6I0I3QzJDRTt9DQoJLnN0MntmaWxsOiNGRkZGRkY7fQ0KCS5zdDN7ZmlsbDojRERFMkU4O30NCgkuc3Q0e2ZpbGw6I0YwRjRGNzt9DQo8L3N0eWxlPg0KPHBhdGggY2xhc3M9InN0MCIgZD0iTTEwNi41LDYyYzAsMjQtMTkuNSw0My41LTQzLjUsNDMuNVMxOS41LDg2LDE5LjUsNjJTMzksMTguNSw2MywxOC41UzEwNi41LDM4LDEwNi41LDYyeiIvPg0KPHBhdGggY2xhc3M9InN0MSIgZD0iTTQ4LjMsNzRsMjIuNS00NC43YzEuMy0yLjUsNC40LTMuNSw3LTIuM2wyMy43LDEyYzEuMywwLjYsMi4zLDEuNywyLjcsM2w0LjcsMTQuOGMwLjQsMS4zLDAuMywyLjctMC4zLDQNCglMOTEsOTUuNGMtMS4zLDIuNi00LjUsMy42LTcuMSwyLjNMNTAuNiw4MUM0OC4xLDc5LjcsNDcuMSw3Ni42LDQ4LjMsNzR6IE00OS4yLDc0LjRsMjIuNS00NC42YzEtMi4xLDMuNi0zLDUuNy0xLjlsMjMuNywxMg0KCWMwLjcsMC4zLDEuMiwwLjgsMS42LDEuNGwtMy4zLDYuNWMtMS4yLDIuNi0wLjIsNS43LDIuNCw3bDYuMywzLjNjMCwwLjcsMCwxLjUtMC40LDIuMkw5MC4yLDk1Yy0xLjEsMi4xLTMuNywyLjgtNS44LDEuOEw1MS4xLDgwLjENCgljLTIuMS0xLTMtMy42LTItNS43SDQ5LjJ6Ii8+DQo8cGF0aCBjbGFzcz0ic3QyIiBkPSJNNzEuNywyOS44TDQ5LjIsNzQuNGMtMSwyLTAuMiw0LjcsMS45LDUuN0w4NC40LDk3YzIuMSwxLjEsNC43LDAuMyw1LjgtMS44bDE3LjUtMzQuOGMwLjMtMC43LDAuNS0xLjUsMC40LTIuMg0KCWwtNi4zLTMuMmMtMi42LTEuMy0zLjYtNC40LTIuNC03bDMuMy02LjZjLTAuNC0wLjYtMS0xLjEtMS42LTEuNEw3Ny40LDI4Yy0yLjEtMS00LjctMC4yLTUuNywxLjlMNzEuNywyOS44eiIvPg0KPHBhdGggY2xhc3M9InN0MSIgZD0iTTc3LDMzLjljMC4xLTAuNCwwLjYtMC41LDEtMC4zbDE3LjUsOC44YzAuNCwwLjIsMC41LDAuNiwwLjMsMWMtMC4yLDAuNC0wLjYsMC41LTAuOSwwLjNsMCwwbC0xNy42LTguOQ0KCUM3Ni45LDM0LjYsNzYuOCwzNC4yLDc3LDMzLjlDNzcsMzMuOCw3NywzMy44LDc3LDMzLjlMNzcsMzMuOXogTTc0LjYsMzguNWMwLjItMC4zLDAuNi0wLjUsMS0wLjNsNi4xLDMuMWMwLjQsMC4yLDAuNSwwLjYsMC4zLDENCgljLTAuMiwwLjQtMC42LDAuNS0wLjksMC4zbC02LjItMy4xQzc0LjUsMzkuMyw3NC40LDM4LjksNzQuNiwzOC41Qzc0LjYsMzguNSw3NC42LDM4LjUsNzQuNiwzOC41eiBNOTYuOCw2Mi4yTDcxLjMsNDkuNA0KCWMtMS4zLTAuNy0yLjgtMC4yLTMuNSwxLjFsLTcuNiwxNWMwLDAsMCwwLDAsMGMtMC42LDEuMy0wLjEsMi44LDEuMiwzLjVsMjUuNCwxMi45YzAsMCwwLjEsMC4xLDAuMiwwLjFjMS4zLDAuNiwyLjgsMCwzLjQtMS4zDQoJbDcuNS0xNUM5OC42LDY0LjQsOTguMSw2Mi44LDk2LjgsNjIuMnogTTkwLjUsNzguMmwtMSwyLjFjLTAuNCwwLjctMS40LDEuMS0yLjIsMC43TDYxLjgsNjguMWMtMC44LTAuNS0xLjEtMS40LTAuNi0yLjNsMS0yDQoJTDkwLjUsNzguMkw5MC41LDc4LjJoMC4xSDkwLjV6IE05MC45LDc3LjNMNjIuNiw2M2wyLjItNC40bDI4LjQsMTQuM0w5MC45LDc3LjN6IE05My42LDcyTDY1LjMsNTcuN2wxLjgtMy41TDY3LDU0LjFsMjguNSwxNC4zDQoJTDkzLjYsNzJ6IE05Nyw2NS4zbC0xLDIuM0w2Ny41LDUzLjNsMS4yLTIuM2MwLjQtMC44LDEuNC0xLjIsMi4yLTAuOGgtMC4xbDI1LjUsMTIuOUM5Ny4xLDYzLjUsOTcuNSw2NC41LDk3LDY1LjN6Ii8+DQo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNNjEuMiwzNC4zYy0wLjUtMC40LTEtMC43LTEuNy0wLjhsLTE0LjgtNC4xYy0xLjMtMC40LTIuOC0wLjItNCwwLjVMMTcuNiw0M2MtMi41LDEuNC0zLjQsNC43LTIsNy4ybDI1LDQzLjMNCgljMS40LDIuNSw0LjcsMy40LDcuMiwybDMyLjMtMTguOGMyLjUtMS40LDMuNC00LjcsMi03LjJMNjIuNywzNmMtMC40LTAuNi0wLjktMS4yLTEuNS0xLjZWMzQuM3ogTTQzLjIsMzAuMmMtMC43LDAtMS40LDAuMi0yLDAuNQ0KCUwxOC4xLDQ0Yy0yLDEuMi0yLjcsMy44LTEuNiw1LjhsMjUsNDMuM2MxLjEsMiwzLjcsMi43LDUuOCwxLjVMNzkuNyw3NmMyLTEuMiwyLjgtMy44LDEuNi01LjlMNjEuOCwzNi40Yy0wLjQtMC43LTAuOS0xLjItMS42LTEuNg0KCWwtNi4xLDMuNmMtMi41LDEuNC01LjgsMC41LTcuMi0yQzQ2LjksMzYuNCw0My4yLDMwLjIsNDMuMiwzMC4yeiIvPg0KPHBhdGggY2xhc3M9InN0MiIgZD0iTTQxLjEsMzAuN2MwLjctMC4zLDEuNC0wLjUsMi4xLTAuNWwzLjcsNi4zYzEuNCwyLjUsNC43LDMuNCw3LjIsMmw2LjEtMy43YzAuNywwLjQsMS4yLDEsMS42LDEuNmwxOS41LDMzLjcNCgljMS4yLDIsMC41LDQuNy0xLjYsNS45TDQ3LjQsOTQuNmMtMiwxLjItNC43LDAuNS01LjktMS41bC0yNS00My4zYy0xLjEtMi0wLjQtNC42LDEuNi01LjhMNDEuMSwzMC43eiIvPg0KPHBhdGggY2xhc3M9InN0MSIgZD0iTTQxLjIsMzguNGwtMTcsOS45Yy0wLjQsMC4yLTEsMC0xLjItMC41Yy0wLjItMC40LTAuMi0xLDAuMi0xLjFsMTctOS45YzAuNC0wLjIsMC44LDAsMS4xLDAuNQ0KCUM0MS42LDM3LjcsNDEuNSwzOC4zLDQxLjIsMzguNHogTTMyLjgsNDguMmMtMC4yLTAuNS0wLjctMC43LTEtMC41bC02LDMuNWMtMC40LDAuMS0wLjQsMC43LTAuMiwxLjFoMC4xYzAuMiwwLjUsMC43LDAuNywxLDAuNQ0KCWw2LTMuNEMzMyw0OS4yLDMzLjEsNDguNiwzMi44LDQ4LjJ6IE03MC4yLDY0LjZMNDMuOCw3OS45Yy0xLjMsMC44LTIuOSwwLjMtMy42LTFsLTguNC0xNC41Yy0wLjctMS4yLTAuMy0yLjgsMC45LTMuNg0KCWMwLDAsMCwwLDAuMSwwbDI2LjQtMTUuMmMxLjMtMC44LDIuOS0wLjMsMy42LDFMNzEuMiw2MUM3MS45LDYyLjIsNzEuNSw2My44LDcwLjIsNjQuNnogTTcwLjMsNjEuNmwtMS4yLTIuMWwwLjEsMGwtMC41LTAuOGwtMC4xLDANCglsLTIuNS00LjNsMCwwbC0wLjUtMC45bDAsMGwtMi0zLjVsMC4xLDBsLTAuNS0wLjhsMCwwTDYxLjksNDdjLTAuNC0wLjctMS40LTEtMi4yLTAuNkwzMy4zLDYxLjdjLTAuOCwwLjUtMS4xLDEuNS0wLjYsMi4ybDEuMiwyLjMNCglsMjkuMy0xN2wwLjUsMC44TDM0LjQsNjdsMiwzLjVsMjkuMy0xN2wwLjUsMC45TDM2LjksNzEuM2wyLjUsNC4zbDI5LjItMTYuOWwwLjUsMC44bC0yOS4yLDE3bDEuMiwyYzAuNCwwLjgsMS40LDEsMi4yLDAuNg0KCWwyNi40LTE1LjNDNzAuNSw2My40LDcwLjgsNjIuNCw3MC4zLDYxLjZ6Ii8+DQo8cGF0aCBjbGFzcz0ic3QyIiBkPSJNMzQuNywzMC4xdjY0LjFjMCwzLDIuNCw1LjQsNS40LDUuNGg0NS40YzMsMCw1LjQtMi40LDUuNC01LjR2LTUwYzAtMC42LTAuMS0xLjItMC4zLTEuN2gtOS4yDQoJYy0zLjUsMC02LjQtMi45LTYuNC02LjRjMCwwLDAtMC4xLDAtMC4xVjI1LjRjLTAuOC0wLjQtMS44LTAuNy0yLjctMC43SDQwYy0zLDAtNS40LDIuNC01LjQsNS40TDM0LjcsMzAuMXoiLz4NCjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik01Mi41LDg5LjhjMCwwLjMtMC4yLDAuNS0wLjUsMC41aC05LjRjLTAuMywwLTAuNC0wLjItMC40LTAuNWMwLTAuMiwwLjEtMC40LDAuNC0wLjRINTINCglDNTIuMyw4OS40LDUyLjUsODkuNiw1Mi41LDg5Ljh6IE00NCwzOC44aDcuNmMwLjUsMCwwLjktMC41LDAuOS0xcy0wLjQtMS0wLjktMUg0NGMtMC41LDAtMSwwLjUtMSwxQzQzLDM4LjQsNDMuNCwzOC44LDQ0LDM4Ljh6DQoJIE00NCwzNWgyMC43YzAuNSwwLDEtMC41LDEtMXMtMC41LTEtMS0xSDQ0Yy0wLjUsMC0xLDAuNS0xLDFDNDMsMzQuNiw0My40LDM1LDQ0LDM1eiBNNjEuNCw4OS40aC00LjdjLTAuMywwLTAuNSwwLjItMC41LDAuNA0KCWMwLDAuMywwLjIsMC41LDAuNSwwLjVoNC43YzAuMywwLDAuNS0wLjIsMC41LTAuNUM2MS45LDg5LjYsNjEuNyw4OS40LDYxLjQsODkuNHogTTg0LjMsNTQuOHYyNGMwLjEsMS4xLTAuOCwyLTEuOSwyLjENCgljMCwwLTAuMSwwLTAuMSwwaC0zOWMtMS4xLDAtMi0wLjktMi0ydi0yNGgtMC4xYzAtMS4yLDEtMi4xLDIuMS0yLjFoMzlDODMuNCw1Mi44LDg0LjMsNTMuOCw4NC4zLDU0Ljh6IE04My4zLDc0LjRoLTQxdjQuNA0KCWMwLDAuNiwwLjQsMS4xLDEsMS4xaDM5YzAuNiwwLDEtMC41LDEtMVY3NC40eiBNODMuMyw2N2gtNDF2Ni40aDQxdjAuMnYtMC4yVjY3eiBNODMuMyw2MC4zaC00MVY2Nmg0MVY2MC4zeiBNODMuMyw1NC44DQoJYzAtMC41LTAuNC0xLTEtMWgtMzl2MC4xYy0wLjYsMC0xLDAuNS0xLDEuMXY0LjRoNDFWNTQuOHoiLz4NCjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik03NSwyNC4zYy0wLjktMC40LTEuOC0wLjYtMi43LTAuNkg0MGMtMy41LDAtNi40LDIuOS02LjQsNi40bDAsMHY2NC4xYzAsMy42LDIuOSw2LjQsNi40LDYuNGg0NS40DQoJYzMuNSwwLDYuNC0yLjgsNi40LTYuNHYtNTBjMC0xLjYtMC43LTMuMi0xLjgtNC40bC0xMy0xNEM3Ni40LDI1LjIsNzUuOCwyNC43LDc1LDI0LjN6IE0zNC43LDk0LjNWMzBjMC0zLDIuNC01LjQsNS40LTUuNGgzMi4yDQoJYzEsMCwxLjksMC4zLDIuNywwLjdWMzZjMCwzLjUsMi45LDYuNCw2LjQsNi40aDkuMmMwLjIsMC41LDAuMywxLDAuMywxLjd2NTBjMCwzLTIuNCw1LjQtNS40LDUuNEg0MGMtMywwLTUuNC0yLjQtNS40LTUuNA0KCUwzNC43LDk0LjN6Ii8+DQo8cGF0aCBjbGFzcz0ic3QzIiBkPSJNMjkuNSw5Ni41YzEsMCwxLjksMC45LDEuOSwxLjlzLTAuOSwxLjktMS45LDEuOXMtMS45LTAuOS0xLjktMS45UzI4LjUsOTYuNSwyOS41LDk2LjV6IE0yNC4zLDI4LjQNCgljMC43LDAsMS4zLDAuNiwxLjMsMS4zUzI1LDMxLDI0LjMsMzFTMjMsMzAuNCwyMywyOS43UzIzLjYsMjguNCwyNC4zLDI4LjR6IE05Ni43LDIxLjhjMC43LDAsMS4zLDAuNiwxLjMsMS4zcy0wLjYsMS4zLTEuMywxLjMNCglzLTEuMy0wLjYtMS4zLTEuM1M5NiwyMS44LDk2LjcsMjEuOHoiLz4NCjxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0xOS44LDMzLjljMS4xLDAsMiwwLjksMiwycy0wLjksMi0yLDJzLTItMC45LTItMlMxOC43LDMzLjksMTkuOCwzMy45eiBNMTAxLjIsMjUuNmMxLjUsMCwyLjcsMS4yLDIuNywyLjcNCglzLTEuMiwyLjctMi43LDIuN3MtMi43LTEuMi0yLjctMi43Uzk5LjcsMjUuNiwxMDEuMiwyNS42eiBNMTAzLjksODVjMC43LDAsMS4zLDAuNiwxLjMsMS4zcy0wLjYsMS4zLTEuMywxLjNzLTEuMy0wLjYtMS4zLTEuMw0KCVMxMDMuMiw4NSwxMDMuOSw4NXoiLz4NCjwvc3ZnPg0K',
  defaultErrorImgSrc: '',
};

type Language = 'ru';
type ImagesMap = {
  /**
   * @description изображение при отсутствии данных (используется в DataGrid)
   */
  noDataImgSrc: string;
  /**
   * @description изображение при ошибке (используется в ContentState)
   */
  defaultErrorImgSrc: string;
};

export type ConfigContextProps = {
  /**
   * @description язык локализации
   * @default 'ru'
   */
  language: Language;
  /**
   * @description языковая карта для DatePicker
   * @default russianMap
   */
  datePickerLanguageMap: LanguageMap;
  /*
   * Callback для отправки ошибки в sentry
   */
  // eslint-disable-next-line
  captureException: (error: any) => void;

  /**
   * @description карта для типовых изображений
   */
  imagesMap: ImagesMap;
};

export type ConfigProviderProps = Partial<ConfigContextProps> & {
  children: ReactNode;
};

export const ConfigContext = createContext<ConfigContextProps>({
  language: 'ru',
  datePickerLanguageMap: russianMap,
  captureException: (error) => console.error(error),
  imagesMap: imagesMapDefault,
});

export const ConfigProvider = ({
  children,
  language = 'ru',
  datePickerLanguageMap = russianMap,
  captureException,
  imagesMap = imagesMapDefault,
}: Partial<ConfigProviderProps>) => {
  useEffect(() => {
    if (!captureException) {
      console.warn(
        'ConfigProvider: Необходимо наличие captureException, связанного с сервисом мониторинга ошибок.\n' +
          'На данный момент все ошибки, отлавливаемые в ErrorBoundary будут выводиться только в консоль',
      );
    }
  }, []);

  return (
    <ConfigContext.Provider
      value={{
        language,
        datePickerLanguageMap,
        captureException: captureException || ((error) => console.error(error)),
        imagesMap,
      }}
    >
      {children}
    </ConfigContext.Provider>
  );
};
